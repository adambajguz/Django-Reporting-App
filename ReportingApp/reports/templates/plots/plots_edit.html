{% extends "base_plots_quickactions.html" %}

{% load custom_tags %}
{% load widget_tweeks %}

{% block breadcrumbs %}
	{{ block.super }} Â» Edit Plot
{% endblock %}

{% block cotainer_start %} 
	<form class="uk-form" method="post" name="edit_form" action="{% url 'plots_edit' id=plot.id %}">
		{% csrf_token %}

{% endblock %}

{% block cotainer_end %} 
	</form>
{% endblock %}

{% block quick_actions %}
	{% for field in plot_form.visible_fields %}
	<div class="uk-form-row">
		<label class="uk-form-label" for="{{ field.name }}">{{ field.label_tag|safe }}</label>

		{% if field.errors %}
		<div class="uk-alert uk-alert-danger">{{ field.errors.as_text }}</div>
		{% endif %}

		<div class="uk-form-controls">
			{{ field }}
			<p class="uk-form-help-block"><em>{{ field.help_text }}</em></p>
		</div>
	</div>
	{% endfor %}

	<p>Last modification: {{ plot.plot_last_modification }}</p>

	<hr style="color: #CCE6FF; border-color: #CCE6FF; background-color: #CCE6FF;">

	<p>Columns properties:</p>
	<div class="uk-panel uk-panel-box" style="max-height: 190px; overflow-y: scroll;">
		<dl class="uk-description-list-line">
			{% for column in columns %}
				<dt><em>{{ column.column_name }}</em></dt>
				<dd>
					<b>Use as: </b>
					<label>
						<input type="checkbox" name="data_col" value="{{ column.id }}" {% if column.id in data_columns %}checked{% endif %}>
						data source, 
					</label>
					<label>
						<input type="checkbox" name="grouping_col" value="{{ column.id }}" {% if column.id in grouping_columns %}checked{% endif %}>
						grouping
					</label>
				</dd>
			{% endfor %}
		</dl>
	</div>

	<hr style="color: #CCE6FF; border-color: #CCE6FF; background-color: #CCE6FF;">

	<button name="delete" value="Delete" class="uk-margin-bottom uk-button uk-button-danger"><i class="uk-icon-trash"></i> Delete plot</button>
	<button class="uk-margin-bottom uk-button uk-button-primary"><i class="uk-icon-save"></i> Save</button>
{% endblock %}

{% block content %}

<div class="uk-width-1-1">
	<div class="uk-overflow-container">
		<embed type="image/svg+xml" src="{{ plot.chart|safe }}"/>
	</div>
</div>

{% if messages %}
   <script>
	{% for message in messages %}
	UIkit.notify('{% if 'safe' in message.tags %}{{ message|safe }}{% else %}{{ message }}{% endif %}', {% if message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}'success'
	{% elif message.level == DEFAULT_MESSAGE_LEVELS.WARNING %}'warning'{% else %} 'danger'{% endif %});    {% endfor %}
   </script>
{% endif %}
{% endblock %}