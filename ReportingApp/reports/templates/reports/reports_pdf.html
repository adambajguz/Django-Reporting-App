{% load custom_tags %}

<!DOCTYPE html>

<html>
<head>
	<style>
		@page {
			size: letter landscape;
			margin: 2cm;
		}

	/* ========================================================================
	Component: Table
	========================================================================== */
	/*
	* 1. Remove most spacing between table cells.
	* 2. Block element behavior
	* 3. Style
	*/
	table {
		/* 1 */
		border-collapse: collapse;
		border-spacing: 0;
		/* 2 */
		width: 100%;
		/* 3 */
		margin-bottom: 15px;
	}

	table th,
	table td {
		border-bottom: 1px solid rgb(0, 0, 0);
		padding: 2px 4px;
	}
	/*
	* Set alignment
	*/
	table th {
		text-align: left;

	}
	table td {
		vertical-align: top;
	}
	table thead th {
		vertical-align: bottom;
	}
	/*
	* Caption and footer
	*/
	table caption,
	table tfoot {
		font-size: 12px;
		font-style: italic;
	}
	table caption {
		text-align: left;
		color: #999;
	}

	/* Sub-modifier: `uk-table-middle`
	========================================================================== */
	.uk-table-middle,
	.uk-table-middle td {
		vertical-align: middle !important;
	}
	/* Modifier: `uk-table-striped`
	========================================================================== */
	.uk-table-striped tbody tr:nth-of-type(odd) {
		background: #fafafa;
	}
	/* Modifier: `uk-table-header-fill`
	========================================================================== */
	.uk-table-header-fill thead tr th {
		background: #cccccc;
	}
	/* Modifier: `uk-table-office`
	========================================================================== */
	.uk-table-office thead tr th {
		background: #68c3ff;
	}
	.uk-table-office tbody tr:nth-of-type(odd) {
		background: #c1ebff;
	}
	.uk-table-office tbody td {
		border-bottom: 1px solid #45abff;
	}
	.uk-table-office tbody tr:hover {
		background: #dff1ff;
	}
	/* Modifier: `uk-table-condensed`
	========================================================================== */
	.uk-table-condensed td {
		padding: 0;
	}

		
	</style>

	<title>{{ spreadsheet.spreadsheet_name }}</title>
</head>
<body>
		<div class="uk-width-1-1">
				<h1>{{ report.report_name }}</h1>
				<h3>{{ report.report_description }}</h2>
			
				<hr>
				{% for element in report_elements %}
					{% if element.element_type == "X" %}
			
						<p>{{ element.text }}</p>
			
					 {% elif element.element_type == "P" %}
			
						<h3>{{ element.caption }}</h3>
						<p class="uk-margin-auto">
							<embed type="image/svg+xml" src="{{ element.plot.chart|safe }}"/>
						</p>
			
					{% elif element.element_type == "T" %}
			
						<h3>{{ element.caption }}</h3>
						<div class="uk-overflow-container">
							<table class="uk-table uk-table-condensed
										{% if element.style == "C" %}uk-table-hover uk-table-striped uk-table-header-fill{% endif %}
										{% if element.style == "M" %}uk-table-hover{% endif %}
										{% if element.style == "O" %}uk-table-office{% endif %}
										{% if element.style == "A" %}uk-table-hover uk-table-striped{% endif %}
										">
								<thead>
									<tr>
										{% if element.style != "M" and element.style != "O" %}<th class="uk-text-bold"><span>No.</span></th>{% endif %}
					
										{% for current_column in element.spreadsheet.table.columns %}
										<th class="uk-text-bold">
											{{current_column.column_name}}
										</th>
										{% endfor %}
									</tr>
								</thead>
					
								<tbody>
									{% for it in element.spreadsheet.table.num_rows %}
									<tr>
										{% if element.style != "M" and element.style != "O" %}
										<td>
											<strong class="uk-float-right">{{forloop.counter}}</strong>
										</td>
										{% endif %}
			
										{% for current_column in element.spreadsheet.table.columns %}
										<td>
											{{ element.spreadsheet.table.rows | index:forloop.counter0 | index:it }}
										</td>
										{% endfor %}
									</tr>
									{% endfor %}
								</tbody>
							</table>
						</div>
			
					{% elif element.element_type == "R" %}
			
						<h3>{{ element.embedded_raport.report_name }}</h3>
			
						<hr>
			
						<div class="uk-width-1-1">			
							{% for element_EM in element.embedded_raport.reportElements.all %}
								{% if element_EM.element_order >= element.element_start and element_EM.element_order <= element.element_end %}
									{% if element_EM.element_type == "X" %}
							
										<p>{{ element_EM.text }}</p>
							
									{% elif element_EM.element_type == "P" %}
							
										<h3>{{ element_EM.caption }}</h3>
										<p class="uk-margin-auto">
											<embed type="image/svg+xml" src="{{ element_EM.plot.chart|safe }}"/>
										</p>
							
									{% elif element_EM.element_type == "T" %}
							
										<h3>{{ element_EM.caption }}</h3>
										<div class="uk-overflow-container">
											<table class="uk-table uk-table-condensed
														{% if element_EM.style == "C" %}uk-table-hover uk-table-striped uk-table-header-fill{% endif %}
														{% if element_EM.style == "M" %}uk-table-hover{% endif %}
														{% if element_EM.style == "O" %}uk-table-office{% endif %}
														{% if element_EM.style == "A" %}uk-table-hover uk-table-striped{% endif %}
														">
												<thead>
													<tr>
														{% if element_EM.style != "M" and element_EM.style != "O" %}<th class="uk-text-bold"><span>No.</span></th>{% endif %}
									
														{% for current_column in element_EM.spreadsheet.table.columns %}
														<th class="uk-text-bold">
															{{current_column.column_name}}
														</th>
														{% endfor %}
													</tr>
												</thead>
									
												<tbody>
													{% for it in element_EM.spreadsheet.table.num_rows %}
													<tr>
														{% if element_EM.style != "M" and element_EM.style != "O" %}
														<td>
															<strong class="uk-float-right">{{forloop.counter}}</strong>
														</td>
														{% endif %}
							
														{% for current_column in element_EM.spreadsheet.table.columns %}
														<td>
															{{ element_EM.spreadsheet.table.rows | index:forloop.counter0 | index:it }}
														</td>
														{% endfor %}
													</tr>
													{% endfor %}
												</tbody>
											</table>
										</div>				
									{% endif %}
								{% endif %}
							{% endfor %}
						</div>
							
			
						<hr>
			
					{% endif %}
				{% endfor %}
			</div>
			
</body>
</html>