{% extends "base_reports_quickactions.html" %}

{% load custom_tags %}
{% load widget_tweeks %}

{% block breadcrumbs %}
	{{ block.super }} Â» Report preview
{% endblock %}

{% block cotainer_start %} 
	<form class="uk-form" method="post" name="edit_form" action="{% url 'reports_preview' id=report.id %}">
		{% csrf_token %}
{% endblock %}

{% block cotainer_end %} 
	</form>
{% endblock %}

{% block quick_actions %}
	
	<p>Creation: {{ report.report_creation_date }}</p>
	<p>Last modification: {{ report.report_last_modification }}</p>

	<hr style="color: #CCE6FF; border-color: #CCE6FF; background-color: #CCE6FF;">

	<button name="pdf" value="PDF" class="uk-margin-bottom uk-button uk-button-primary"><i class="uk-icon-file-pdf-o"></i> Generate PDF</button>
	<p>
		<button name="edit" value="Edit" class="uk-margin-bottom uk-button uk-button-success"><i class="uk-icon-pencil"></i> Edit report</button>
		<button name="delete" value="Delete" class="uk-margin-bottom uk-button uk-button-danger"><i class="uk-icon-trash"></i> Delete report</button>
	</p>
{% endblock %}

{% block content %}

<div class="uk-width-1-1">
	<h1>{{ report.report_name }}</h1>
	<h3>{{ report.report_description }}</h2>

	<hr>
	{% for element in report_elements %}
		{% if element.element_type == "X" %}

			<p>{{ element.text }}</p>

		{% elif element.element_type == "P" %}

			<h3>{{ element.caption }}</h3>
			<p class="uk-margin-auto">
				<embed type="image/svg+xml" src="{{ element.plot.chart|safe }}"/>
			</p>

		{% elif element.element_type == "T" %}

			<h3>{{ element.caption }}</h3>
			<div class="uk-overflow-container">
				<table class="uk-table uk-table-condensed
							{% if element.style == "C" %}uk-table-hover uk-table-striped uk-table-header-fill{% endif %}
							{% if element.style == "M" %}uk-table-hover{% endif %}
							{% if element.style == "O" %}uk-table-office{% endif %}
							{% if element.style == "A" %}uk-table-hover uk-table-striped{% endif %}
							">
					<thead>
						<tr>
							{% if element.style != "M" and element.style != "O" %}<th class="uk-text-bold"><span>No.</span></th>{% endif %}
		
							{% for current_column in element.spreadsheet.table.columns %}
							<th class="uk-text-bold">
								{{current_column.column_name}}
							</th>
							{% endfor %}
						</tr>
					</thead>
		
					<tbody>
						{% for it in element.spreadsheet.table.num_rows %}
						<tr>
							{% if element.style != "M" and element.style != "O" %}
							<td>
								<strong class="uk-float-right">{{forloop.counter}}</strong>
							</td>
							{% endif %}

							{% for current_column in element.spreadsheet.table.columns %}
							<td>
								{{ element.spreadsheet.table.rows | index:forloop.counter0 | index:it }}
							</td>
							{% endfor %}
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>

		{% elif element.element_type == "R" %}

			<h3>{{ element.embedded_raport.report_name }}</h3>

			<hr>

			<div class="uk-width-1-1">			
				{% for element_EM in element.embedded_raport.reportElements.all %}
					{% if element_EM.element_order >= element.element_start and element_EM.element_order <= element.element_end %}
						{% if element_EM.element_type == "X" %}
				
							<p>{{ element_EM.text }}</p>
				
						{% elif element_EM.element_type == "P" %}
				
							<h3>{{ element_EM.caption }}</h3>
							<p class="uk-margin-auto">
								<embed type="image/svg+xml" src="{{ element_EM.plot.chart|safe }}"/>
							</p>
				
						{% elif element_EM.element_type == "T" %}
				
							<h3>{{ element_EM.caption }}</h3>
							<div class="uk-overflow-container">
								<table class="uk-table uk-table-condensed
											{% if element_EM.style == "C" %}uk-table-hover uk-table-striped uk-table-header-fill{% endif %}
											{% if element_EM.style == "M" %}uk-table-hover{% endif %}
											{% if element_EM.style == "O" %}uk-table-office{% endif %}
											{% if element_EM.style == "A" %}uk-table-hover uk-table-striped{% endif %}
											">
									<thead>
										<tr>
											{% if element_EM.style != "M" and element_EM.style != "O" %}<th class="uk-text-bold"><span>No.</span></th>{% endif %}
						
											{% for current_column in element_EM.spreadsheet.table.columns %}
											<th class="uk-text-bold">
												{{current_column.column_name}}
											</th>
											{% endfor %}
										</tr>
									</thead>
						
									<tbody>
										{% for it in element_EM.spreadsheet.table.num_rows %}
										<tr>
											{% if element_EM.style != "M" and element_EM.style != "O" %}
											<td>
												<strong class="uk-float-right">{{forloop.counter}}</strong>
											</td>
											{% endif %}
				
											{% for current_column in element_EM.spreadsheet.table.columns %}
											<td>
												{{ element_EM.spreadsheet.table.rows | index:forloop.counter0 | index:it }}
											</td>
											{% endfor %}
										</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>				
						{% endif %}
					{% endif %}
				{% endfor %}
			</div>
				

			<hr>

		{% endif %}
	{% endfor %}
</div>




{% endblock %}